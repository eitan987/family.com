(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2773:function(e,t,r){Promise.resolve().then(r.bind(r,7650)),Promise.resolve().then(r.bind(r,5480))},7650:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return LoginForm}});var o=r(9),n=r(2265),a=r(1396),i=r.n(a),l=r(4033),s=r(7870),c=r(6454),u=r(4932);function LoginForm(){let e=(0,l.useRouter)(),[t,r]=(0,n.useState)({email:"",password:"",rememberMe:!1}),[a,d]=(0,n.useState)(""),[m,p]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(()=>{{let t=localStorage.getItem("currentUser");t&&(console.log("User already logged in, redirecting to home page"),e.push("/home"))}})()},[e]);let handleChange=e=>{let{name:t,value:o,type:n,checked:a}=e.target;r(e=>({...e,[t]:"checkbox"===n?a:o}))},handleSubmit=async r=>{r.preventDefault(),p(!0),d("");try{await c.kv.login(t.email,t.password),console.log("Login successful, redirecting to home page"),t.rememberMe,setTimeout(()=>{e.push("/home")},500)}catch(e){var o;console.error("Login error:",e),(null===(o=e.message)||void 0===o?void 0:o.includes("Network Error"))?d("לא הצלחנו להתחבר לשרת. נסה שוב מאוחר יותר."):d("שם משתמש או סיסמה שגויים"),p(!1)}},b={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0,transition:{type:"spring",stiffness:300,damping:24}}},g={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:24}},hover:{scale:1.02},tap:{scale:.98}};return(0,o.BX)(s.E.div,{className:"text-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[(0,o.tZ)("h1",{className:"text-2xl font-bold mb-2",children:"ברוכים הבאים"}),(0,o.tZ)("p",{className:"text-gray-600 mb-6",children:"התחבר לאפליקציית המשפחה"}),(0,o.BX)(s.E.form,{onSubmit:handleSubmit,className:"space-y-6",variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,staggerChildren:.1,when:"beforeChildren"}}},initial:"hidden",animate:"visible",children:[(0,o.BX)(s.E.div,{variants:b,children:[(0,o.tZ)("label",{htmlFor:"email",className:"block text-sm font-medium text-right mb-1",children:"כתובת אימייל"}),(0,o.BX)("div",{className:"relative",children:[(0,o.tZ)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,o.tZ)(u.GYo,{className:"text-gray-400"})}),(0,o.tZ)(s.E.input,{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:t.email,onChange:handleChange,className:"w-full p-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"your@email.com",dir:"ltr",whileFocus:{scale:1.01,borderColor:"#4f46e5"}})]})]}),(0,o.BX)(s.E.div,{variants:b,children:[(0,o.BX)("div",{className:"flex justify-between items-center",children:[(0,o.tZ)(i(),{href:"/forgot-password",className:"text-sm text-blue-600 hover:underline",children:"שכחת סיסמה?"}),(0,o.tZ)("label",{htmlFor:"password",className:"block text-sm font-medium",children:"סיסמה"})]}),(0,o.BX)("div",{className:"relative mt-1",children:[(0,o.tZ)(s.E.input,{id:"password",name:"password",type:h?"text":"password",autoComplete:"current-password",required:!0,value:t.password,onChange:handleChange,className:"w-full p-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"********",dir:"ltr",whileFocus:{scale:1.01,borderColor:"#4f46e5"}}),(0,o.tZ)("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 cursor-pointer",onClick:()=>{f(!h)},children:h?(0,o.tZ)(u.hKY,{className:"text-gray-400"}):(0,o.tZ)(u.rWO,{className:"text-gray-400"})})]})]}),(0,o.tZ)(s.E.div,{className:"flex items-center justify-end",variants:b,children:(0,o.BX)("div",{className:"flex items-center",children:[(0,o.tZ)("input",{id:"rememberMe",name:"rememberMe",type:"checkbox",checked:t.rememberMe,onChange:handleChange,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded ml-2"}),(0,o.tZ)("label",{htmlFor:"rememberMe",className:"block text-sm text-gray-700",children:"זכור אותי"})]})}),a&&(0,o.tZ)(s.E.div,{className:"bg-red-50 text-red-500 p-3 rounded-md text-sm font-medium",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{type:"spring"},children:a}),(0,o.tZ)(s.E.div,{variants:g,children:(0,o.tZ)(s.E.button,{type:"submit",className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",variants:g,whileHover:"hover",whileTap:"tap",disabled:m,children:m?"מעבר...":"התחברות"})}),(0,o.BX)(s.E.div,{className:"text-center text-sm text-gray-600 mt-6",variants:b,children:[(0,o.BX)("p",{className:"px-8",children:["וסיסמה כלשהי: dan@family.com למטרות הדגמה",(0,o.tZ)("br",{}),"(לפחות 4 תווים)"]}),(0,o.BX)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:["אין לך חשבון עדיין?"," ",(0,o.tZ)(i(),{href:"/register",className:"text-blue-600 hover:underline font-medium",children:"הירשם עכשיו"})]})]})]})]})}},5480:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return DebugInfo}});var o=r(2265);function DebugInfo(){return(0,o.useEffect)(()=>{console.log("Debug info: Application loaded successfully"),console.log("Current URL:",window.location.href),console.log("Hostname:",window.location.hostname),console.log("Port:",window.location.port),console.log("Protocol:",window.location.protocol)},[]),null}},6454:function(e,t,r){"use strict";r.d(t,{kv:function(){return a}});var o=r(4829);let n=o.Z.create({baseURL:"http://localhost:5000/api",headers:{"Content-Type":"application/json"},withCredentials:!0});n.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e));let a={login:async(e,t)=>{try{let r=await n.post("/auth/login",{email:e,password:t});return r.data.token&&(localStorage.setItem("token",r.data.token),localStorage.setItem("currentUser",JSON.stringify(r.data.user))),r.data}catch(e){throw console.error("שגיאה בהתחברות:",e),e}},logout:async()=>{try{return await n.get("/auth/logout"),localStorage.removeItem("token"),localStorage.removeItem("currentUser"),{success:!0}}catch(e){throw console.error("שגיאה בהתנתקות:",e),e}},getCurrentUser:async()=>{try{let e=await n.get("/auth/me");return e.data}catch(e){throw console.error("שגיאה בקבלת פרטי משתמש:",e),e}},updateUserDetails:async e=>{try{let t=await n.put("/auth/updatedetails",e);return t.data.user&&localStorage.setItem("currentUser",JSON.stringify(t.data.user)),t.data}catch(e){throw console.error("שגיאה בעדכון פרטי משתמש:",e),e}},updatePassword:async(e,t)=>{try{let r=await n.put("/auth/updatepassword",{currentPassword:e,newPassword:t});return r.data}catch(e){throw console.error("שגיאה בשינוי סיסמה:",e),e}}}},3118:function(e,t,r){"use strict";r.d(t,{w_:function(){return GenIcon}});var o=r(2265),n={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},a=o.createContext&&o.createContext(n),i=["attr","size","title"];function _objectWithoutProperties(e,t){if(null==e)return{};var r,o,n=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;r[o]=e[o]}return r}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e}).apply(this,arguments)}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:t+""}function _toPrimitive(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function Tree2Element(e){return e&&e.map((e,t)=>o.createElement(e.tag,_objectSpread({key:t},e.attr),Tree2Element(e.child)))}function GenIcon(e){return t=>o.createElement(IconBase,_extends({attr:_objectSpread({},e.attr)},t),Tree2Element(e.child))}function IconBase(e){var elem=t=>{var r,{attr:n,size:a,title:l}=e,s=_objectWithoutProperties(e,i),c=a||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),o.createElement("svg",_extends({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,s,{className:r,style:_objectSpread(_objectSpread({color:e.color||t.color},t.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),l&&o.createElement("title",null,l),e.children)};return void 0!==a?o.createElement(a.Consumer,null,e=>elem(e)):elem(n)}}},function(e){e.O(0,[706,901,450,971,472,744],function(){return e(e.s=2773)}),_N_E=e.O()}]);